# Elinity Full Backend Architecture Reference (Mobile Integration)

This document provides a comprehensive technical reference for the entire Elinity ecosystem. It covers all 110+ backend modules, organized by functional domain.

---

## üåç Base URL & Spec
- **Production API**: `https://api.elinity.ai`
- **Interactive Swagger**: `{BASE_URL}/docs`
- **ReDoc (Professional View)**: `{BASE_URL}/redoc`

---

## üîê 1. Identity & Access (Auth)
Primary entry point for user lifecycle.
- `POST /auth/register`: Create new user.
- `POST /auth/login`: Returns JWT Access/Refresh tokens.
- `POST /auth/refresh`: Rotate expired tokens.
- `GET /users/me`: Fetch the full authenticated profile.

---

## üë§ 2. The Identity Hub (Deep Profile)
Elinity captures a high-resolution map of the user's psyche.
- **Personal Info**: `PUT /users/me/personal-info`
- **Psychological Traits**: 
  - `PUT /users/me/big-five-traits`: Openness, Conscientiousness, etc.
  - `PUT /users/me/mbti-traits`: Introversion, Intuition, etc.
  - `PUT /users/me/psychology`: Deep mental health and attachment style data.
- **Preferences**: `PUT /users/me/relationship-preferences`, `friendship-preferences`, `collaboration-preferences`.
- **Identity Tags**: `PUT /users/me/interests-and-hobbies`, `favorites`, `values-beliefs-and-goals`.
- **Media**: `POST /users/me/profile-picture/upload` (Supports Azure/Local storage).

---

## üí´ 3. Lumi AI Core (Human Synergy)
Powered by NVIDIA NIM Llama-3.1-405B for radical awareness.
- **Core Chat**: `POST /lumi/chat/`
- **Specialized Modes**: `POST /ai-mode/{mode_name}/start`
  - Modes: `deep_thinking`, `socratic`, `metacognition`, `visualization`, `meditation`, `pep_talk`, `reality_check`.
- **Historical Personas**: Chat with `socrates_historical`, `nietzsche`, `da_vinci`, `aurelius`.

---

## üìñ 4. Smart Journaling & Sanctuary
- **Journaling**:
  - `POST /journal/`: Create entry.
  - `POST /journal/{id}/moodscape`: NVIDIA -> Flux.1 Image Pipeline.
- **Lifebook**: `GET/POST /lifebook/` - Strategic life planning and visioning.
- **Sanctuary**: Private space for reflection and AI-generated visuals.

---

## üéÆ 5. The Gaming Sanctuary (Multiplayer)
Real-time interaction with the "Story Weaver" and 50+ other frequencies.
- **Session Mgmt**:
  - `POST /games/multiplayer/create`: Creates a lobby and generates a **Room Code**.
  - `POST /games/multiplayer/join`: Join a session via Room Code.
  - `POST /games/multiplayer/status`: Toggle 'Ready' state.
- **Real-time State**: Uses the `GameManager` to handle state synchronization across clients.
- **AI Observation**: `_ai_observer.py` analyzes gameplay to award "Insight Points" based on truth-matching and behavior.

---

## ü§ù 6. Social & Community
- **Feed**: `GET /feed/` (Posts, Likes, Comments).
- **Visual Perspectives**: `POST /feed/{post_id}/moodscape` (Social AI Art).
- **Discovery**: `GET /recommendations/` - AI-powered member matching based on Big Five/Interests.
- **Connections**: `GET /connections/` - Manage friends, matches, and "Personal Circle".
- **Lumi Coach**: `POST /lumi/relationship-coach/analyze-chat/{group_id}` - Triggers background NLP analysis of conversation health.

---

## üìà 7. Skills & Evaluation
- **Skill Domains**: 
  - `GET /self-growth/`
  - `GET /social/`
  - `GET /relationship-skills/`
- **Evaluation**: `POST /evaluate/` - Submit behavior/answers for AI skill-level assessment.

---

## üõ†Ô∏è 8. System Utilities
- **Global Search**: `GET /search/global?q=...` - Scans Events, Posts, and Journals.
- **Notifications**: `GET /notifications/` - Real-time alerts for connections, insights, and nudges.
- **Dashboard**: `GET /dashboard/me` (Personal stats) & `GET /dashboard/relationship` (Social stats).
- **Billing**: `GET /plans/` (Subscription management).
- **Voice Onboarding**: `POST /onboarding/voice` - AI voice synthesis and interaction.

---

## ÔøΩ 9. File Handling
- **Uploads**: `POST /upload-file` - Generic multipart/form-data handler.
- **Static Assets**: `{BASE_URL}/static/moodscapes/` - Direct access to generated PNGs.

---

## ÔøΩ Developer Protocol
1. **Error Handling**: Standard HTTP status codes (401=Unauthorized, 404=Not Found, 422=Validation Error).
2. **Context**: Use the `user_summary` returned in Lumi responses to build personalized mobile UI widgets.
3. **Draft Mode**: Some endpoints (blogs, events) are currently in MVP state; check `main.py` for full routing status.

---
*Generated by Elinity Core Assistant - Comprehensive Deployment Sync v1.1*
